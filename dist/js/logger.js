"use strict";$(document).ready(function(){$(window).on("hashchange",function(){"#feedback"==window.location.hash&&$("#feedback-modal").modal("show")}).trigger("hashchange")}),$("#feedback-btn").click(function(){window.location.hash="#feedback",$("#feedback-modal").modal("show")}),$("#feedback-modal").on("hidden.bs.modal",function(){console.log(window.location.hash),"#feedback"==window.location.hash&&removeHash()}),$("#bug-affected-pages").val(window.location.href),$("#issueType").change(function(){let e=$(this).val();$(".feedback-section:not(.feedback-"+e+")").collapse("hide"),$(".feedback-"+e).collapse("show"),$(".feedback-hide.feedback-"+e+"-hide").addClass("hidden"),$(".feedback-hide:not(.feedback-"+e+"-hide)").removeClass("hidden")});let getInfo=function(){return{userAgent:window.navigator.userAgent,browserByDuckTyping:window.chrome&&window.chrome.webstore?"chrome":"undefined"!=typeof InstallTrigger?"firefox":/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString()?"safari":window.opr&&opr.addons||window.opera||navigator.userAgent.indexOf(" OPR/")>=0?"opera":document.documentMode?"ie":!isIE&&window.StyleMedia?"edge":(isChrome||isOpera)&&window.CSS?"blink":"unknown",platform:window.navigator.platform,detectedOS:(e=window.navigator.userAgent,a=window.navigator.platform,n=null,-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(a)?n="Mac OS":-1!==["iPhone","iPad","iPod"].indexOf(a)?n="iOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(a)?n="Windows":/Android/.test(e)?n="Android":!n&&/Linux/.test(a)&&(n="Linux"),n),navigator:function(){let e={};for(let a in navigator)e[a]=navigator[a];return delete e.plugins,delete e.mimeTypes,e}()};var e,a,n},bugFields=[{name:"title",validation:/^(.|\n){10,150}$/,maxLength:150,minLength:10},{name:"description",validation:/^(.|\n){0,5000}$/,maxLength:5e3,minLength:0},{name:"affected-pages",validation:/^(.|\n){0,500}$/,maxLength:500,minLength:0},{name:"name",validation:/^(.|\n){3,100}$/,general:!0},{name:"email",validation:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/,general:!0}];for(let e=0;e<bugFields.length;e++){let a=function(){let a=$("#"+(bugFields[e].general?"":"bug-")+bugFields[e].name).val(),n=a.length;if(void 0!==bugFields[e].maxLength&&void 0!==bugFields[e].minLength){let a=n>=bugFields[e].minLength;$("#"+(bugFields[e].general?"":"bug-")+bugFields[e].name+"-unit").text(a?" / "+bugFields[e].maxLength:" characters to go"),$("#"+(bugFields[e].general?"":"bug-")+bugFields[e].name+"-length").text(a?n:bugFields[e].minLength-n)}let i=bugFields[e].validation.test(a);i&&!0!==bugFields[e].wasValid?bugFields[e].wasValid=!0:i||!0!==bugFields[e].wasValid?$("#"+(bugFields[e].general?"":"bug-")+bugFields[e].name).hasClass("is-invalid")&&$("#"+(bugFields[e].general?"":"bug-")+bugFields[e].name).removeClass("is-invalid"):$("#"+(bugFields[e].general?"":"bug-")+bugFields[e].name).addClass("is-invalid")};$("#"+(bugFields[e].general?"":"bug-")+bugFields[e].name).on("change paste keyup",a),a()}let getExtensionFromFilename=function(e){return e.slice((Math.max(0,e.lastIndexOf("."))||1/0)+1)},upload=function(e,a,n){console.log("Size",e.size);var i={contentType:e.type},d=firebase.storage().ref(),o=firebase.database().ref("/feedback/"+a+"/").push(),l=d.child("/feedback/"+a+"/files/"+o.key).put(e,i);$("#upload-control, #feedback-progress").removeClass("hidden"),$("#upload-control-pause").click(function(){l.pause(),$("#upload-control-pause").addClass("hidden"),$("#upload-control-resume").removeClass("hidden")}),$("#upload-control-resume").click(function(){l.resume(),$("#upload-control-resume").addClass("hidden"),$("#upload-control-pause").removeClass("hidden")}),$("#upload-control-cancel").click(function(){l.cancel(),$(".uploading-show, #feedback-loading").addClass("hidden"),$(".uploading-hide, #feedback-main").removeClass("hidden")}),l.on(firebase.storage.TaskEvent.STATE_CHANGED,function(e){var a=e.bytesTransferred/e.totalBytes*100;switch(a=Math.round(100*a)/100,$("#feedback-progressbar").css("width",a+"%"),$("#feedback-progressbar").html(a+"%"),$("#feedback-progressbar").attr("aria-valuenow",a+"%"),e.state){case firebase.storage.TaskState.PAUSED:$("#upload-control-play").addClass("hidden"),$("#upload-control-resume").removeClass("hidden"),console.log("Upload is paused");break;case firebase.storage.TaskState.RUNNING:$("#upload-control-resume").addClass("hidden"),$("#upload-control-play").removeClass("hidden"),console.log("Upload is running")}},function(e){switch(e.code){case"storage/canceled":break;case"storage/cannot-slice-blob":$("#feedback-modal .modal-body").addClass("hidden"),$("#feedback-filechangederror").removeClass("hidden");break;default:$("#feedback-error-data").html(btoa(JSON.stringify(e)))}},function(){l.snapshot.ref.getDownloadURL().then(function(e){console.log("File available at",e),n(e,o)})})};$("#feedback-submit").click(function(){let e=function(){$(".uploading-hide").addClass("hidden"),$(".uploading-show").removeClass("hidden"),$("#feedback-modal").modal({backdrop:"static",keyboard:!1})},a=$("#issueType").val();switch(a){case"bug":!function(e){let n=!1;for(let e=0;e<bugFields.length;e++){let a=!0===bugFields[e].general?$("#"+bugFields[e].name).val():$("#bug-"+bugFields[e].name).val();console.log(bugFields[e].general,bugFields[e].name,a),bugFields[e].validation.test(a)||(n=!0,$((bugFields[e].general?"#":"#bug-")+bugFields[e].name).addClass("is-invalid"))}var i=$("#bug-file")[0].files[0];i.size>105906176&&($("#bug-file").addClass("is-invalid"),$("#bug-file-group invalid-feedback").removeClass(""),n=!0),n||(e(),$("#feedback-main").addClass("hidden"),$("#feedback-loading").removeClass("hidden"),$("#feedback-progressbar").css("width","0%"),$("#feedback-progressbar").html("0%"),$("#feedback-progressbar").attr("aria-valuenow","0%"),upload(i,"bug",function(e,n){firebase.database().ref("/feedback/"+a+"/"+n.key).push({file:e,timestamp:(new Date).getTime(),humanReadableTimestamp:new Date}),$("#feedback-modal .modal-body").addClass("hidden"),$("#feedback-done").removeClass("hidden"),$("#feedback-modal").modal({backdrop:!0,keyboard:!0})}))}(e);break;case"feature":e()}}),$(".custom-file-input").on("change",function(){var e=$(this).val();e=e.substring(e.lastIndexOf("\\")+1),console.log(e),$("#bug-file").hasClass("is-invalid")&&$("#bug-file").removeClass("is-invalid"),$(this).next(".custom-file-label").css("white-space: nowrap;overflow:hidden;"),$(this).next(".custom-file-label").html(e)}),$("#bug-file-clear").click(function(){$("#bug-file").val(null),$("#bug-file").next(".custom-file-label").html("Choose File")});var Logger={log:function(){}};